import{M as b}from"./bootstrap.esm-434bcbc7.js";import{b as g}from"./axios-61e5193b.js";import{u as f}from"./userStore-61de1e54.js";import{l as p,v as y}from"./runtime-dom.esm-bundler-466e0a51.js";import{b7 as P,ak as d,m as c,n as t,aK as i,l as v,t as h,b4 as u,F as x,au as w}from"./plugin-vueexport-helper-6c478766.js";import"./index-f28331f7.js";const{VITE_APIPATH:_,VITE_URL:m}={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APIPATH:"panduola666",BASE_URL:"./",MODE:"production",DEV:!1,PROD:!0},k={data(){return{postModal:{},currentProduct:{title:"",category:"",origin_price:"",price:"",unit:"",description:"",is_enabled:!0,imageUrl:""},products:[]}},methods:{...g(f,["checkLogin"]),getProducts(){this.$http(`${m}/api/${_}/admin/products/all`).then(l=>{const{products:e}=l.data;this.products=Object.values(e)})},showProduct(l){const e=this.products.findIndex(n=>n.id===l);this.currentProduct=this.products[e]},currentProductInfo(l,e){if(l==="editor"&&e){const n=this.products.findIndex(r=>r.id===e);this.currentProduct={...this.products[n]}}l==="new"&&(this.currentProduct=this.$options.data().currentProduct)},postAJAX(){const l=this.currentProduct;if(!l.imageUrl){alert("請上傳封面");return}const e=l.id?`/${l.id}`:"";let n="post";e&&(n="put"),this.$http[n](`${m}/api/${_}/admin/product${e}`,{data:l}).then(r=>{alert(r.data.message),this.postModal.hide(),this.getProducts()}).catch(r=>{alert(r.response.data.message)})},postImg(l){const e=l.target.files[0],n=new FormData;n.append("img",e),this.$http.post(`${m}/api/${_}/admin/upload`,n).then(r=>{const{imageUrl:s}=r.data;this.currentProduct.imageUrl=s}).catch(r=>{alert(r.response.data.message)})},deleteProduct(l){this.$http.delete(`${m}/api/${_}/admin/product/${l}`).then(e=>{alert(e.data.message),this.getProducts()}).catch(e=>{alert(e.response.data.message)})}},mounted(){this.checkLogin(),this.getProducts(),this.postModal=new b(this.$refs.postModal)}},M={class:"modal fade",id:"postModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"postModal"},U={class:"modal-dialog modal-dialog-centered modal-xl modal-dialog-scrollable"},V={class:"modal-content"},C={class:"modal-header bg-dark"},I={class:"modal-title text-white",id:"exampleModalLabel"},A=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),L={class:"modal-body row"},E=t("br",null,null,-1),T={class:"col-4"},D=t("label",{for:"cover",class:"fs-4"},"* 封面",-1),B={class:"border bg-white d-flex align-items-center justify-content-around",style:{"min-height":"200px"}},R=["src"],j={type:"button",class:"btn py-2 btn-primary w-100 position-relative overflow-hidden"},F={class:"col d-flex flex-column gap-3"},J={class:"row"},N={class:"col"},O=t("label",{for:"title",class:"fs-4"},"* 名稱",-1),S={class:"row"},X={class:"col"},H=t("label",{for:"category",class:"fs-4"},"* 分類",-1),K={class:"col"},q=t("label",{for:"unit",class:"fs-4"},"* 單位",-1),z={class:"row"},G={class:"col"},Q=t("label",{for:"origin_price",class:"fs-4"},"* 原價",-1),W={class:"col"},Y=t("label",{for:"price",class:"fs-4"},"* 優惠價",-1),Z=t("label",{for:"description",class:"fs-5"},"商品描述",-1),$=t("label",{for:"is_enabled"},"上架商品",-1),tt={class:"modal-footer"},et=t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1),st={class:"table table-hover align-middle text-center"},ot=t("thead",null,[t("tr",null,[t("th"),t("th",null,"商品名稱"),t("th",null,"價格"),t("th",null,"狀態"),t("th")])],-1),lt=["onClick"],it={key:0,class:"m-0"},nt={key:1},rt={class:"m-0 text-danger fs-5"},dt={key:0,class:"text-success"},ct={key:1,class:"text-danger"},at=["onClick"],ut=["onClick"],pt={class:"modal fade",id:"productModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_t={class:"modal-dialog modal-dialog-centered modal-xl"},mt={class:"modal-content"},ht={class:"modal-header bg-dark"},bt={class:"modal-title text-white",id:"exampleModalLabel"},gt=t("button",{type:"button",class:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),ft={class:"modal-body row"},yt={class:"col"},Pt=["src","alt"],vt={class:"col"},xt={class:"btn btn-primary rounded-pill"},wt=t("p",null,"商品描述：",-1),kt={key:0,class:"fs-4"},Mt={key:1},Ut={class:"text-danger fs-4"},Vt=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 關閉 ")],-1);function Ct(l,e,n,r,s,a){return d(),c("div",null,[t("button",{type:"button",class:"btn btn-lg btn-primary float-end me-5","data-bs-toggle":"modal","data-bs-target":"#postModal",onClick:e[0]||(e[0]=()=>a.currentProductInfo("new"))}," 新增商品 "),t("div",M,[t("div",U,[t("div",V,[t("div",C,[t("h5",I,i(s.currentProduct.title?"編輯商品":"新增商品"),1),A]),t("div",L,[E,t("div",T,[D,t("div",B,[s.currentProduct.imageUrl?(d(),c("img",{key:0,src:s.currentProduct.imageUrl,alt:"",class:"img-fluid"},null,8,R)):v("",!0),h(" "+i(s.currentProduct.imageUrl?"":"請上傳封面"),1)]),t("button",j,[t("input",{type:"file",name:"cover",id:"cover",class:"position-absolute bg-dark top-0 start-0 end-0 bottom-0 opacity-0",style:{cursor:"pointer",transform:"scale(2)"},onChange:e[1]||(e[1]=o=>a.postImg(o))},null,32),h(" 上傳圖片 ")])]),t("div",F,[t("div",J,[t("div",N,[O,u(t("input",{type:"text",name:"title",id:"title",class:"w-100","onUpdate:modelValue":e[2]||(e[2]=o=>s.currentProduct.title=o)},null,512),[[p,s.currentProduct.title]])])]),t("div",S,[t("div",X,[H,u(t("input",{type:"text",name:"category",id:"category",class:"w-100","onUpdate:modelValue":e[3]||(e[3]=o=>s.currentProduct.category=o)},null,512),[[p,s.currentProduct.category]])]),t("div",K,[q,u(t("input",{type:"text",name:"unit",id:"unit",class:"w-100","onUpdate:modelValue":e[4]||(e[4]=o=>s.currentProduct.unit=o)},null,512),[[p,s.currentProduct.unit]])])]),t("div",z,[t("div",G,[Q,u(t("input",{type:"number",name:"origin_price",id:"origin_price",class:"w-100","onUpdate:modelValue":e[5]||(e[5]=o=>s.currentProduct.origin_price=o)},null,512),[[p,s.currentProduct.origin_price,void 0,{number:!0}]])]),t("div",W,[Y,u(t("input",{type:"number",name:"price",id:"price",class:"w-100","onUpdate:modelValue":e[6]||(e[6]=o=>s.currentProduct.price=o)},null,512),[[p,s.currentProduct.price,void 0,{number:!0}]])])]),t("div",null,[Z,u(t("textarea",{name:"description",id:"description",class:"w-100",rows:"5","onUpdate:modelValue":e[7]||(e[7]=o=>s.currentProduct.description=o)},null,512),[[p,s.currentProduct.description]])]),t("div",null,[u(t("input",{type:"checkbox",class:"is_enabled me-1",id:"is_enabled","onUpdate:modelValue":e[8]||(e[8]=o=>s.currentProduct.is_enabled=o)},null,512),[[y,s.currentProduct.is_enabled]]),$])])]),t("div",tt,[et,t("button",{type:"button",class:"btn btn-primary",onClick:e[9]||(e[9]=(...o)=>a.postAJAX&&a.postAJAX(...o))}," 確定 ")])])])],512),t("table",st,[ot,t("tbody",null,[(d(!0),c(x,null,w(s.products,o=>(d(),c("tr",{key:o.id},[t("td",null,[t("button",{type:"button",class:"btn btn-close",onClick:()=>a.deleteProduct(o.id)},null,8,lt)]),t("td",null,i(o.title),1),t("td",null,[o.origin_price===o.price?(d(),c("p",it,i(o.price)+" 元 ",1)):(d(),c("div",nt,[t("del",null,"原價 "+i(o.origin_price)+" 元",1),t("p",rt," 現在只要 "+i(o.price)+" 元 ",1)]))]),t("td",null,[o.is_enabled?(d(),c("p",dt,"已上架")):(d(),c("p",ct,"未上架"))]),t("td",null,[t("button",{type:"button",class:"btn btn-outline-secondary","data-bs-toggle":"modal","data-bs-target":"#productModal",onClick:()=>a.showProduct(o.id)}," 商品詳情 ",8,at),t("button",{type:"button",class:"btn btn-outline-primary","data-bs-toggle":"modal","data-bs-target":"#postModal",onClick:()=>a.currentProductInfo("editor",o.id)}," 編輯 ",8,ut)])]))),128))])]),t("div",pt,[t("div",_t,[t("div",mt,[t("div",ht,[t("h5",bt,i(s.currentProduct.title),1),gt]),t("div",ft,[t("div",yt,[t("img",{src:s.currentProduct.imageUrl,alt:s.currentProduct.title,class:"w-100",style:{"object-fit":"cover","max-height":"400px"}},null,8,Pt)]),t("div",vt,[t("h2",null,[h(i(s.currentProduct.title)+" ",1),t("span",xt,i(s.currentProduct.category),1)]),wt,t("p",null,i(s.currentProduct.description),1),s.currentProduct.origin_price===s.currentProduct.price?(d(),c("p",kt,i(s.currentProduct.price)+" 元 ",1)):(d(),c("div",Mt,[t("del",null,"原價 "+i(s.currentProduct.origin_price)+" 元",1),t("p",Ut," 現在只要 "+i(s.currentProduct.price)+" 元 ",1)]))])]),Vt])])])])}const Bt=P(k,[["render",Ct]]);export{Bt as default};
